<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>ch.vd.dfin.tao</groupId>
    <artifactId>tao-parent-plugin</artifactId>
    <version>1.0.0</version>
  </parent>

  <groupId>ch.vd.dfin.tao.tao-pm</groupId>
  <packaging>jar</packaging>
  <artifactId>tao-pm-engine-api</artifactId>
  <version>24R3.A.1-SNAPSHOT</version>
  <name>Libraire de calcul PM</name>

  <!-- ###### SCM : Source Control Management ###### -->
  <!-- définition de l'url de connection au serveur GIT pour le projet -->
  <scm>
    <connection>scm:git:ssh://git@bitbucket.etat-de-vaud.ch/fisc/taopm-engine-api.git</connection>
    <developerConnection>scm:git:ssh://git@bitbucket.etat-de-vaud.ch/fisc/taopm-engine-api.git</developerConnection>
    <url>https://portail.etat-de-vaud.ch/outils/git/projects/FISC/repos/taopm-engine-api</url>
    <tag>HEAD</tag>
  </scm>

  <properties>

    <jdk.version>1.11</jdk.version>
    <maven.compiler.target>1.11</maven.compiler.target>
    <maven.compiler.source>1.11</maven.compiler.source>
    <maven.compiler.release>11</maven.compiler.release>
    <java.version>1.11</java.version>
    <project.encoding>UTF-8</project.encoding>

    <taoexchange-version>24R3.A.7</taoexchange-version>
    <generated.sources.version>24R3.A.12</generated.sources.version>
    <taopm.version>24R3.A.4</taopm.version>
    <taocore.version>24R3.A.7</taocore.version>
    <fidor.version>1.16</fidor.version>

    <spring.version>5.2.20.RELEASE</spring.version>
    <spring.boot.version>2.2.6.RELEASE</spring.boot.version>
    <ehcache.version>2.6.11</ehcache.version>
    <commons.lang.version>2.6</commons.lang.version>
    <commons.lang3.version>3.8.1</commons.lang3.version>
    <commons.beanutils.version>1.9.3</commons.beanutils.version>
    <cloning.version>1.9.2</cloning.version>
    <guava.version>19.0</guava.version>
    <commons.vfs.version>1.0</commons.vfs.version>
    <javax.annotation.version>1.3.2</javax.annotation.version>
    <jaxb.version>2.3.2</jaxb.version>
    <glassfish.jersey.version>2.29.1</glassfish.jersey.version>

  </properties>

  <build>
    <pluginManagement>
      <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.8.0</version>
            <configuration>
                <encoding>${project.encoding}</encoding>
                <source>${java.version}</source>
                <target>${java.version}</target>
            </configuration>
        </plugin>
      </plugins>
    </pluginManagement>
  </build>

  <dependencies>
    <!-- dépendances PM -->
    <dependency>
      <groupId>${project.groupId}</groupId>
      <artifactId>tao-pm-services</artifactId>
      <version>${taopm.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>${project.groupId}</groupId>
      <artifactId>tao-pm-engine</artifactId>
      <version>${taopm.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>${project.groupId}</groupId>
      <artifactId>tao-pm-metier</artifactId>
      <version>${taopm.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>

    <!-- Dépendances tao-core -->
    <dependency>
      <groupId>ch.vd.dfin.tao.core</groupId>
      <artifactId>tao-engine</artifactId>
      <version>${taocore.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>ch.vd.dfin.tao.core</groupId>
      <artifactId>tao-engine-impl</artifactId>
      <version>${taocore.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>ch.vd.dfin.tao.core</groupId>
      <artifactId>tao-core-api</artifactId>
      <version>${taocore.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>ch.vd.dfin.tao.core</groupId>
      <artifactId>tao-core-impl</artifactId>
      <version>${taocore.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>

    <!-- Dépendance tao-exchange -->
    <dependency>
      <groupId>ch.vd.dfin.tao</groupId>
      <artifactId>tao-exchange</artifactId>
      <version>${taoexchange-version}</version>
      <exclusions>
        <exclusion>
            <groupId>*</groupId>
            <artifactId>*</artifactId>
        </exclusion>
    </exclusions>
    </dependency>
    <!-- Dépendances generated sources -->
    <dependency>
      <groupId>ch.vd.dfin.tao</groupId>
      <artifactId>tao-exchange-generated-sources</artifactId>
      <version>${generated.sources.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>ch.vd.fidor</groupId>
      <artifactId>fidor-jaxb2</artifactId>
      <version>${fidor.version}</version>
      <exclusions>
          <exclusion>
              <groupId>*</groupId>
              <artifactId>*</artifactId>
          </exclusion>
      </exclusions>
    </dependency>

    <!-- Dépendances tiers -->

    <!-- dependances spring -->
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-beans</artifactId>
      <version>${spring.version}</version>
    </dependency>
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-context</artifactId>
      <version>${spring.version}</version>
    </dependency>
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-context-support</artifactId>
      <version>${spring.version}</version>
      <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-starter-logging</artifactId>
      <version>${spring.boot.version}</version>
    </dependency>
    <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-autoconfigure</artifactId>
      <version>${spring.boot.version}</version>
    </dependency>
    <dependency>
      <groupId>net.sf.ehcache</groupId>
      <artifactId>ehcache-core</artifactId>
      <version>${ehcache.version}</version>
      <exclusions>
        <exclusion>
          <artifactId>slf4j-api</artifactId>
          <groupId>org.slf4j</groupId>
        </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>commons-lang</groupId>
      <artifactId>commons-lang</artifactId>
      <version>${commons.lang.version}</version>
    </dependency>
    <dependency>
      <groupId>org.apache.commons</groupId>
      <artifactId>commons-lang3</artifactId>
      <version>${commons.lang3.version}</version>
    </dependency>
    <dependency>
      <groupId>commons-beanutils</groupId>
      <artifactId>commons-beanutils</artifactId>
      <version>${commons.beanutils.version}</version>
    </dependency>

    <!-- utilisé dans ChampMonoVaéeur et ChampMultivaleur -->
    <dependency>
      <groupId>uk.com.robust-it</groupId>
      <artifactId>cloning</artifactId>
      <version>${cloning.version}</version>
    </dependency>
    <dependency>
      <groupId>com.google.guava</groupId>
      <artifactId>guava</artifactId>
      <version>${guava.version}</version>
    </dependency>

    <!-- utilisé par spring boot  initilaisation des propriétés par fichier -->
    <dependency>
      <groupId>commons-vfs</groupId>
      <artifactId>commons-vfs</artifactId>
      <version>${commons.vfs.version}</version>
      <exclusions>
        <exclusion>
          <artifactId>commons-logging</artifactId>
          <groupId>commons-logging</groupId>
        </exclusion>
      </exclusions>
    </dependency>

    <!-- faire le tri sur ce qui est vraiment utile pour lé'appel Fidor -->
    <dependency>
      <groupId>javax.annotation</groupId>
      <artifactId>javax.annotation-api</artifactId>
      <version>${javax.annotation.version}</version>
    </dependency>
    <!-- jaxb -->
    <!-- désérialisation des fichiers xml -->
    <dependency>
      <groupId>org.glassfish.jaxb</groupId>
      <artifactId>jaxb-runtime</artifactId>
      <version>${jaxb.version}</version>
    </dependency>

    <!-- glassfish -->
    <!-- Objet client des appels de ws fidor -->
    <dependency>
      <groupId>org.glassfish.jersey.core</groupId>
      <artifactId>jersey-client</artifactId>
      <version>${glassfish.jersey.version}</version>
    </dependency>
    <dependency>
      <groupId>org.glassfish.jersey.inject</groupId>
      <artifactId>jersey-hk2</artifactId>
      <version>${glassfish.jersey.version}</version>
      <exclusions>
        <exclusion>
          <artifactId>jakarta.annotation-api</artifactId>
          <groupId>jakarta.annotation</groupId>
        </exclusion>
      </exclusions>
    </dependency>
    <!-- Déserialization des objets retournés par les ws -->
    <dependency>
    <groupId>org.glassfish.jersey.media</groupId>
      <artifactId>jersey-media-jaxb</artifactId>
      <version>${glassfish.jersey.version}</version>
    </dependency>

    <!-- Apache POI pour excel -->
    <dependency>
      <groupId>org.apache.poi</groupId>
      <artifactId>poi</artifactId>
      <version>3.12</version>
    </dependency>

    <!-- Dépendances de test  -->
    <dependency>
      <groupId>org.junit.jupiter</groupId>
      <artifactId>junit-jupiter-api</artifactId>
      <version>5.8.2</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.junit.jupiter</groupId>
      <artifactId>junit-jupiter-engine</artifactId>
      <version>5.8.2</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.junit.platform</groupId>
      <artifactId>junit-platform-launcher</artifactId>
      <version>1.8.2</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-test</artifactId>
      <version>${spring.version}</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>org.springframework.boot</groupId>
      <artifactId>spring-boot-test</artifactId>
      <version>${spring.boot.version}</version>
      <scope>test</scope>
    </dependency>

  </dependencies>

  <profiles>
    <profile>
      <id>extractTestAutonome</id>
      <properties>
        <maven.test.skip>true</maven.test.skip>
        <output-folder>${project.basedir}/livrable-test-autonome</output-folder>
      </properties>
      <build>
        <plugins>

          <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-dependency-plugin</artifactId>
          <version>3.2.0</version>
          <executions>
          <!-- tao-engine-impl -->
          <execution>
          <id>copy-tao-engine</id>
          <phase>package</phase>
          <goals>
            <goal>copy</goal>
            <!-- <goal>copy</goal>-->
          </goals>
          <configuration>
          <artifactItems>
          <!-- item de dépendance de tao-pm-engine !-->
          <artifactItem>
            <groupId>ch.vd.dfin.tao.tao-pm</groupId>
            <artifactId>tao-pm-engine-api</artifactId>
            <version>${project.version}</version>
            <type>jar</type>
          </artifactItem>
          </artifactItems>
            <outputDirectory>${output-folder}</outputDirectory>
            <overWriteReleases>true</overWriteReleases>
            <overWriteSnapshots>true</overWriteSnapshots>
            </configuration>
           </execution>
          <execution>
            <id>copy-dependencies</id>
            <phase>package</phase>
            <goals>
              <goal>copy-dependencies</goal>
            </goals>
            <configuration>
              <outputDirectory>${output-folder}/lib</outputDirectory>
            </configuration>
          </execution>
          </executions>
          </plugin>
          <plugin>
            <artifactId>maven-resources-plugin</artifactId>
            <version>3.1.0</version>
            <executions>
              <execution>
                <id>copy-resource-one</id>
                <phase>generate-sources</phase>
                <goals>
                  <goal>copy-resources</goal>
                </goals>
                <configuration>
                  <outputDirectory>${output-folder}/</outputDirectory>
                  <resources>
                  <resource>
                      <directory>${project.basedir}/src/cmd</directory>
                      <includes>
                        <include>readme.txt</include>
                        <include>launch.bat</include>
                      </includes>
                    </resource>
                    <resource>
                      <directory>${project.basedir}/</directory>
                      <includes>
                        <include>src/application.properties</include>
                      </includes>
                    </resource>
                  </resources>
                </configuration>
              </execution>

            </executions>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>
</project>