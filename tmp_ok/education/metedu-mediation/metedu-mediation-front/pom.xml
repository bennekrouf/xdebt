<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <!-- =======================================================================
    = PARENT
    ======================================================================== -->
    <parent>
        <groupId>ch.vd.education.metedu.mediation</groupId>
        <artifactId>metedu-mediation</artifactId>
        <version>1.0.0-SNAPSHOT</version>
    </parent>

    <!-- =======================================================================
    = PROJECT
    ======================================================================== -->
    <artifactId>metedu-mediation-front</artifactId>
    <name>MET-EDU Mediation (front)</name>

    <!-- =======================================================================
    = PROPERTIES
    ======================================================================== -->
    <properties>
        <super.deploy.enabled>false</super.deploy.enabled>
        <super.owasp.enabled>false</super.owasp.enabled>
        <!--:: FRONT :::::::::::::::::::::::::::::::::::::::::::::::::::: -->
        <exec-maven-plugin.workingDirectory.front>${project.basedir}/front</exec-maven-plugin.workingDirectory.front>
        <angular.test.argument>test:ci</angular.test.argument>
        <angular.lint.argument>lint</angular.lint.argument>
        <angular.buildprod.argument>build:prod</angular.buildprod.argument>

        <node.packagemanager.executable>yarn</node.packagemanager.executable>
    </properties>

    <!-- =======================================================================
    = MODULES
    ======================================================================== -->
    <modules>
    </modules>

    <!-- =======================================================================
    = DEPENDENCIES MANAGEMENT
    ======================================================================== -->
    <dependencyManagement>
    </dependencyManagement>

    <!-- =======================================================================
    = BUILD
    ======================================================================== -->
    <build>
        <plugins>
            <plugin>
                <artifactId>maven-clean-plugin</artifactId>
                <version>${maven-clean-plugin.version}</version>
                <configuration>
                    <filesets>
                        <fileset>
                            <directory>${exec-maven-plugin.workingDirectory.front}/coverage</directory>
                            <followSymlinks>false</followSymlinks>
                        </fileset>
                        <fileset>
                            <directory>${exec-maven-plugin.workingDirectory.front}/dist</directory>
                            <followSymlinks>false</followSymlinks>
                        </fileset>
                    </filesets>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>exec-maven-plugin</artifactId>
                <version>${org.codehaus.mojo.exec-maven-plugin.version}</version>
                <executions>
                    <execution>
                        <id>exec-front-install</id>
                        <phase>prepare-package</phase>
                        <configuration>
                            <workingDirectory>${exec-maven-plugin.workingDirectory.front}</workingDirectory>
                            <executable>${node.packagemanager.executable}</executable>
                            <arguments>
                                <argument>install</argument>
                                <argument>--pure-lockfile</argument> <!-- only for yarn but does not harm for npm -->
                            </arguments>
                            <skip>${build.nofront}</skip>
                        </configuration>
                        <goals>
                            <goal>exec</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>exec-ngcli-tests</id>
                        <phase>prepare-package</phase>
                        <configuration>
                            <workingDirectory>${exec-maven-plugin.workingDirectory.front}</workingDirectory>
                            <executable>${node.packagemanager.executable}</executable>
                            <arguments>
                                <argument>run</argument>
                                <argument>${angular.test.argument}</argument>
                            </arguments>
                            <skip>${skipTests}</skip>
                        </configuration>
                        <goals>
                            <goal>exec</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>exec-ngcli-lint</id>
                        <phase>prepare-package</phase>
                        <configuration>
                            <workingDirectory>${exec-maven-plugin.workingDirectory.front}</workingDirectory>
                            <executable>${node.packagemanager.executable}</executable>
                            <arguments>
                                <argument>run</argument>
                                <argument>${angular.lint.argument}</argument>
                            </arguments>
                            <skip>${skipTests}</skip>
                        </configuration>
                        <goals>
                            <goal>exec</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>exec-ngcli-build</id>
                        <phase>prepare-package</phase>
                        <configuration>
                            <workingDirectory>${exec-maven-plugin.workingDirectory.front}</workingDirectory>
                            <executable>${node.packagemanager.executable}</executable>
                            <arguments>
                                <argument>run</argument>
                                <argument>${angular.buildprod.argument}</argument>
                            </arguments>
                            <skip>${build.nofront}</skip>
                        </configuration>
                        <goals>
                            <goal>exec</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

</project>
