<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <!-- =======================================================================
    = PARENT
    ======================================================================== -->
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.2.13.RELEASE</version>
    </parent>

    <!-- =======================================================================
    = PROJECT
    ======================================================================== -->
    <groupId>ch.vd.formation.inexta</groupId>
    <artifactId>inextaweb</artifactId>
    <version>11.0.3-SNAPSHOT</version>
    <packaging>war</packaging>
    <name>Inexta</name>

    <scm>
        <connection>${scm.connexion}</connection>
        <developerConnection>${scm.connexion}</developerConnection>
        <url>${scm.url}</url>
        <tag>HEAD</tag>
    </scm>

    <!-- =======================================================================
    = PROPERTIES
    ======================================================================== -->
    <properties>
        <deployUnit>inextaweb</deployUnit>
        <scm.connexion>scm:git:ssh://git@bitbucket.etat-de-vaud.ch/education/inexta.git</scm.connexion>
        <scm.url>https://dsigit.etat-de-vaud.ch/outils/git/projects/EDUCATION/repos/inexta/browse</scm.url>

        <java.version>11</java.version>
        <lombok.version>1.18.22</lombok.version>
        <org.mapstruct.version>1.5.3.Final</org.mapstruct.version>
        <org.mapstruct.extensions.spring.version>1.0.0</org.mapstruct.extensions.spring.version>
        <lombok-mapstruct-binding.version>0.2.0</lombok-mapstruct-binding.version>
        <io.inugami.version>3.3.1</io.inugami.version>
        <com.github.tomakehurst.wiremock-jre8.version>2.35.0</com.github.tomakehurst.wiremock-jre8.version>
        <org.eclipse.jetty.version>9.4.51.v20230217</org.eclipse.jetty.version>
        <jaxb2-version>1.11.1</jaxb2-version>
        <maven-jaxb2-plugin-version>0.14.0</maven-jaxb2-plugin-version>
        <jaxb2-basics-annotate-version>1.1.0</jaxb2-basics-annotate-version>
        <metedu-shared-xsd.version>1.0.5</metedu-shared-xsd.version>
        <metedu-xsd.directory>${project.build.directory}/metedu</metedu-xsd.directory>
        <metedu-domain-xsd.directory>${metedu-xsd.directory}/xsd/domain</metedu-domain-xsd.directory>
        <metedu-request-xsd.directory>${metedu-xsd.directory}/xsd/request</metedu-request-xsd.directory>
        <metedu-response-xsd.directory>${metedu-xsd.directory}/xsd/response</metedu-response-xsd.directory>

        <oracle.jdbc>12.1.0.2.0</oracle.jdbc>
        <hibernate.version>5.4.33.Final</hibernate.version>

        <!-- use UTF-8 for everything -->
        <project.bumappild.sourceEncoding>UTF-8</project.bumappild.sourceEncoding>
        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
        <start-class>ch.vd.formation.InextaSpringBootApplication</start-class>

        <!-- Parametres de testing -->
        <surefire.useFile>false</surefire.useFile>
        <failsafe.useFile>false</failsafe.useFile>
        <skipTests>false</skipTests>

        <!-- librairies DSI -->
        <pee-shared-base.version>5.0.7</pee-shared-base.version>
        <shared-iam.version>7.0.0</shared-iam.version>
<!--        <pee-shared-testing.version>5.0.8</pee-shared-testing.version>-->
        <pee-shared-testing.version>6.0.3</pee-shared-testing.version>
        <refedu-shared-xsd-version>1.0.2</refedu-shared-xsd-version>

        <!-- plugins maven -->
        <maven.source.skip>true</maven.source.skip>
        <maven-surefire-plugin.version>2.22.2</maven-surefire-plugin.version>
        <maven-failsafe-plugin.version>2.19.1</maven-failsafe-plugin.version>
        <maven-resources-plugin.version>2.7</maven-resources-plugin.version>
        <maven-assembly-plugin.version>3.3.0</maven-assembly-plugin.version>
        <build-helper-maven-plugin.version>1.9.1</build-helper-maven-plugin.version>
        <maven-compiler-plugin.version>3.2</maven-compiler-plugin.version>
        <maven-jar-plugin.version>2.5</maven-jar-plugin.version>
        <maven-release-plugin.version>3.0.1</maven-release-plugin.version>
        <buildnumber-maven-plugin.version>1.3</buildnumber-maven-plugin.version>
        <jaxb2-maven-plugin.version>2.5.0</jaxb2-maven-plugin.version>
        <jaxb-fluent-api.version>2.1.8</jaxb-fluent-api.version>
        <jaxb2-commons-lang.version>2.4</jaxb2-commons-lang.version>

        <!-- === DEPLOIEMENT === -->
        <timestamp>${maven.build.timestamp}</timestamp>
        <maven.build.timestamp.format>dd-MM-yyyy'T'HH:mm</maven.build.timestamp.format>

        <scriptExtension>bat</scriptExtension>
        <build.nofront>false</build.nofront>

        <devex-maven-plugin.version>2.0.0</devex-maven-plugin.version>
        <devex-maven-plugin.releaseVersion>${project.version}</devex-maven-plugin.releaseVersion>
        <devex-maven-plugin.deployUnit>${deployUnit}</devex-maven-plugin.deployUnit>
        <devex-maven-plugin.deployTarget>Tomcat</devex-maven-plugin.deployTarget>
        <devex-maven-plugin.configTag>master</devex-maven-plugin.configTag>
        <devex-maven-plugin.warProjectOnly>false</devex-maven-plugin.warProjectOnly>

        <devex.profiles>devex.release,devex.in</devex.profiles>
        <release.goals>clean deploy</release.goals>
        <release.profiles>not,nexus,${devex.profiles}</release.profiles>

        <assembly.finalName>${deployUnit}-${project.version}</assembly.finalName>
        <executable.finalName>${deployUnit}</executable.finalName>

        <junit.jupiter.version>5.7.0</junit.jupiter.version>
        <junit.platform.version>1.2.0</junit.platform.version>
    </properties>

    <!-- =======================================================================
    = DEPENDENCIES MANAGEMENT
    ======================================================================== -->
    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>ch.vd.pee</groupId>
                <artifactId>pee-shared-base</artifactId>
                <version>${pee-shared-base.version}</version>
                <exclusions>
                    <exclusion>
                        <groupId>log4j</groupId>
                        <artifactId>log4j</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.jencks</groupId>
                        <artifactId>jencks</artifactId>
                    </exclusion>
                    <exclusion>
                        <groupId>org.tranql</groupId>
                        <artifactId>tranql-connector-oracle-common</artifactId>
                    </exclusion>
                </exclusions>
            </dependency>

            <dependency>
                <groupId>ch.vd.shared</groupId>
                <artifactId>shared-iam</artifactId>
                <version>${shared-iam.version}</version>
            </dependency>

            <dependency>
                <groupId>oracle.jdbc</groupId>
                <artifactId>ojdbc7</artifactId>
                <version>${oracle.jdbc}</version>
            </dependency>

            <dependency>
                <groupId>ch.vd.education</groupId>
                <artifactId>metedu-shared-xsd</artifactId>
                <version>${metedu-shared-xsd.version}</version>
            </dependency>

            <dependency>
                <groupId>io.inugami</groupId>
                <artifactId>inugami_commons_test</artifactId>
                <version>${io.inugami.version}</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>io.github.openfeign</groupId>
                <artifactId>feign-core</artifactId>
                <version>${io.github.openfeign.version}</version>
            </dependency>

            <dependency>
                <groupId>io.github.openfeign</groupId>
                <artifactId>feign-jackson</artifactId>
                <version>${io.github.openfeign.version}</version>
            </dependency>

            <dependency>
                <groupId>com.github.tomakehurst</groupId>
                <artifactId>wiremock-jre8-standalone</artifactId>
                <version>${com.github.tomakehurst.wiremock-jre8.version}</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>org.eclipse.jetty</groupId>
                <artifactId>jetty-util</artifactId>
                <version>${org.eclipse.jetty.version}</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>org.eclipse.jetty</groupId>
                <artifactId>jetty-io</artifactId>
                <version>${org.eclipse.jetty.version}</version>
                <scope>test</scope>
            </dependency>

            <dependency>
                <groupId>org.eclipse.jetty</groupId>
                <artifactId>jetty-server</artifactId>
                <version>${org.eclipse.jetty.version}</version>
                <scope>test</scope>
            </dependency>
        </dependencies>
    </dependencyManagement>

    <!-- =======================================================================
    = DEPENDENCIES
    ======================================================================== -->
    <dependencies>
        <dependency>
            <groupId>ch.vd.formation</groupId>
            <artifactId>refedu-shared-xsd</artifactId>
            <version>${refedu-shared-xsd-version}</version>
        </dependency>

        <dependency>
            <groupId>ch.vd.education</groupId>
            <artifactId>metedu-shared-xsd</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-tomcat</artifactId>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-thymeleaf</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- ESB -->
        <dependency>
            <groupId>ch.vd.technical.esb</groupId>
            <artifactId>esb-client-spring-boot-starter</artifactId>
            <version>5.6.1</version>
        </dependency>

        <!-- ESB: Starter pour obtenir la ConnectionFactory vers activeMQ-->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-activemq</artifactId>
        </dependency>

        <dependency>
            <groupId>org.jvnet.jaxb2_commons</groupId>
            <artifactId>jaxb2-basics</artifactId>
            <version>${jaxb2-version}</version>
        </dependency>

        <dependency>
            <groupId>org.jvnet.jaxb2_commons</groupId>
            <artifactId>jaxb2-basics-annotate</artifactId>
            <version>${jaxb2-basics-annotate-version}</version>
        </dependency>

        <dependency> <!-- OK -->
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
        </dependency>

        <dependency>  <!-- OK -->
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-taglibs</artifactId>
            <version>5.3.3.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.apache.poi</groupId>
            <artifactId>poi-ooxml</artifactId>
            <version>4.1.2</version>
        </dependency>

        <!-- VD -->
        <dependency>
            <groupId>ch.vd.pee</groupId>
            <artifactId>pee-shared-base</artifactId>
        </dependency>

        <dependency>
            <groupId>ch.vd.shared</groupId>
            <artifactId>shared-iam</artifactId>
        </dependency>

        <!-- LOGS & MONITOR -->
        <dependency> <!-- OK -->
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>

        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <version>1.2.3</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>1.7.30</version>
        </dependency>

        <!-- javamelody-core -->
        <dependency>
            <groupId>net.bull.javamelody</groupId>
            <artifactId>javamelody-core</artifactId>
            <version>1.85.0</version>
        </dependency>

        <!-- itext, option to add PDF export -->
        <dependency>
            <groupId>com.itextpdf</groupId>
            <artifactId>itextpdf</artifactId>
            <version>5.5.13.1</version>
            <exclusions>
                <exclusion>
                    <artifactId>bcmail-jdk14</artifactId>
                    <groupId>bouncycastle</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>bcprov-jdk14</artifactId>
                    <groupId>bouncycastle</groupId>
                </exclusion>
                <exclusion>
                    <artifactId>bctsp-jdk14</artifactId>
                    <groupId>bouncycastle</groupId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>com.thoughtworks.xstream</groupId>
            <artifactId>xstream</artifactId>
            <version>1.4.11.1</version>
        </dependency>

        <!-- TOOLS AND TOOLKITS -->
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-lang3</artifactId>
            <version>3.11</version>
        </dependency>

        <dependency>
            <groupId>commons-lang</groupId>
            <artifactId>commons-lang</artifactId>
            <version>2.6</version>
            <scope>compile</scope>
        </dependency>

        <dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>2.7</version>
        </dependency>

        <dependency>
            <groupId>com.google.guava</groupId>
            <artifactId>guava</artifactId>
            <version>29.0-jre</version>
        </dependency>

        <dependency>
            <groupId>org.mozilla</groupId>
            <artifactId>rhino</artifactId>
            <version>1.7.12</version>
        </dependency>

        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger2</artifactId>
            <version>3.0.0</version>
        </dependency>

        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger-ui</artifactId>
            <version>3.0.0</version>
        </dependency>

        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-boot-starter</artifactId>
            <version>3.0.0</version>
        </dependency>

        <!-- DB -->
        <dependency>
            <groupId>oracle.jdbc</groupId>
            <artifactId>ojdbc7</artifactId>
            <!--version 12.1.0.2.0-->
        </dependency>

        <dependency>
            <groupId>org.springframework.data</groupId>
            <artifactId>spring-data-oracle</artifactId>
            <version>1.2.1.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-csv</artifactId>
            <version>1.10.0</version>
        </dependency>

        <dependency>
            <groupId>com.querydsl</groupId>
            <artifactId>querydsl-jpa</artifactId>
            <version>4.2.2</version>
        </dependency>

        <dependency>
            <groupId>com.querydsl</groupId>
            <artifactId>querydsl-apt</artifactId>
            <version>4.2.2</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>com.zaxxer</groupId>
            <artifactId>HikariCP</artifactId>
            <version>3.4.5</version>
            <scope>compile</scope>
        </dependency>

        <dependency> <!-- OK -->
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.mockito</groupId>
            <artifactId>mockito-all</artifactId>
            <version>1.10.19</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.assertj</groupId>
            <artifactId>assertj-core</artifactId>
            <version>3.16.1</version>
            <scope>test</scope>
        </dependency>

        <dependency> <!-- OK -->
            <groupId>ch.vd.pee</groupId>
            <artifactId>pee-shared-testing</artifactId>
            <version>${pee-shared-testing.version}</version>
            <scope>test</scope>
            <exclusions>
                <exclusion>
                    <groupId>log4j</groupId>
                    <artifactId>log4j</artifactId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>io.cucumber</groupId>
            <artifactId>cucumber-rhino</artifactId>
            <version>1.2.6</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>io.inugami</groupId>
            <artifactId>inugami_commons_test</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>com.github.tomakehurst</groupId>
            <artifactId>wiremock-jre8-standalone</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-util</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-io</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-server</artifactId>
            <scope>test</scope>
        </dependency>

        <!-- Lombok dependencies -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>${lombok.version}</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.mapstruct</groupId>
            <artifactId>mapstruct</artifactId>
            <version>${org.mapstruct.version}</version>
        </dependency>

        <dependency>
            <groupId>org.mapstruct.extensions.spring</groupId>
            <artifactId>mapstruct-spring-annotations</artifactId>
            <version>${org.mapstruct.extensions.spring.version}</version>
        </dependency>
    </dependencies>

    <!-- =======================================================================
    = BUILD
    ======================================================================== -->
    <build>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-release-plugin</artifactId>
                    <version>${maven-release-plugin.version}</version>
                    <configuration>
                        <goals>${release.goals}</goals>
                        <pushChanges>true</pushChanges>
                        <releaseProfiles>${release.profiles}</releaseProfiles>
                        <tagNameFormat>@{project.version}</tagNameFormat>
                    </configuration>
                </plugin>

                <plugin>
                    <groupId>ch.vd.devex</groupId>
                    <artifactId>devex-maven-plugin</artifactId>
                    <version>${devex-maven-plugin.version}</version>
                    <configuration>
                        <configTag>${devex-maven-plugin.configTag}</configTag>
                        <releaseVersion>${devex-maven-plugin.releaseVersion}</releaseVersion>
                        <deployUnit>${devex-maven-plugin.deployUnit}</deployUnit>
                        <deployTarget>${devex-maven-plugin.deployTarget}</deployTarget>
                        <warProjectOnly>${devex-maven-plugin.warProjectOnly}</warProjectOnly>
                    </configuration>
                </plugin>
            </plugins>
        </pluginManagement>

        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <configuration>
                    <reuseForks>false</reuseForks>
                    <forkCount>1</forkCount>
                </configuration>
            </plugin>

            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.8.1</version>
                <configuration>
                    <source>${java.version}</source>
                    <target>${java.version}</target>
                    <showDeprecation>true</showDeprecation>
                    <encoding>UTF-8</encoding>

                    <!-- Lombok - MapStruct-->
                    <annotationProcessorPaths>
                        <path>
                            <groupId>org.mapstruct</groupId>
                            <artifactId>mapstruct-processor</artifactId>
                            <version>${org.mapstruct.version}</version>
                        </path>
                        <path>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                            <version>${lombok.version}</version>
                        </path>
                        <path>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok-mapstruct-binding</artifactId>
                            <version>${lombok-mapstruct-binding.version}</version>
                        </path>
                    </annotationProcessorPaths>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <executions>
                    <execution>
                        <id>unpack</id>
                        <phase>generate-sources</phase>
                        <goals>
                            <goal>unpack</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>ch.vd.education</groupId>
                                    <artifactId>metedu-shared-xsd</artifactId>
                                </artifactItem>
                            </artifactItems>
                            <outputDirectory>${metedu-xsd.directory}</outputDirectory>
                            <overWriteReleases>false</overWriteReleases>
                            <overWriteSnapshots>true</overWriteSnapshots>
                        </configuration>
                    </execution>
                </executions>
            </plugin>

            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>jaxb2-maven-plugin</artifactId>
                <version>${jaxb2-maven-plugin.version}</version>
                <executions>
                    <execution>
                        <id>eleveMoyennesQualifiantes-lagapep-request</id>
                        <goals>
                            <goal>xjc</goal>
                        </goals>
                        <configuration>
                            <catalog>${metedu-request-xsd.directory}/catalog.xml</catalog>
                            <xjbSources>
                                <xjbSource>src/main/resources/bindings/common.xjb</xjbSource>
                            </xjbSources>
                            <sources>
                                <source>${metedu-request-xsd.directory}/event/1/eventRequest-1-1.xsd</source>
                                <source>${metedu-request-xsd.directory}/fm/personne/eleveAllFM/1/eleveAllFM-1-0.xsd</source>
                                <source>${metedu-domain-xsd.directory}/eleve/moyennesQualifiantes/1/eleveMoyennesQualifiantes-1-1.xsd</source>
                            </sources>
                            <packageName>ch.vd.formation.inexta.integration.lagapep.request.message.eleveMoyennesQualifiantes</packageName>
                            <arguments>
                                <argument>-XautoNameResolution</argument>
                                <argument>-Xcommons-lang</argument>
                                <argument>-Xfluent-api</argument>
                            </arguments>
                            <clearOutputDir>false</clearOutputDir>
                        </configuration>
                    </execution>
                    <execution>
                        <id>eleveMoyennesQualifiantes-lagapep-response</id>
                        <goals>
                            <goal>xjc</goal>
                        </goals>
                        <configuration>
                            <catalog>${metedu-response-xsd.directory}/catalog.xml</catalog>
                            <xjbSources>
                                <xjbSource>src/main/resources/bindings/common.xjb</xjbSource>
                            </xjbSources>
                            <sources>
                                <source>${metedu-response-xsd.directory}/event/1/eventResponse-1-0.xsd</source>
                                <source>${metedu-response-xsd.directory}/fm/personne/ack/1/ackEleveAllFM-1-0.xsd</source>
                                <source>${metedu-response-xsd.directory}/fm/personne/ack/eleve/moyennesQualifiantes/1/ackEleveMoyennesQualifiantes-1-1.xsd</source>
                            </sources>
                            <packageName>ch.vd.formation.inexta.integration.lagapep.response.message.eleveMoyennesQualifiantes</packageName>
                            <arguments>
                                <argument>-XautoNameResolution</argument>
                                <argument>-Xcommons-lang</argument>
                                <argument>-Xfluent-api</argument>
                            </arguments>
                            <clearOutputDir>false</clearOutputDir>
                        </configuration>
                    </execution>
                </executions>
                <dependencies>
                    <dependency>
                        <groupId>net.java.dev.jaxb2-commons</groupId>
                        <artifactId>jaxb-fluent-api</artifactId>
                        <version>${jaxb-fluent-api.version}</version>
                    </dependency>
                    <dependency>
                        <groupId>org.jvnet.jaxb2_commons</groupId>
                        <artifactId>jaxb2-commons-lang</artifactId>
                        <version>${jaxb2-commons-lang.version}</version>
                    </dependency>
                </dependencies>
            </plugin>

            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>

            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>3.2.2</version>
                <configuration>
                    <archive>
                        <manifestEntries>
                            <Manifest-Version>${project.version}</Manifest-Version>&gt;
                            <Application-Version>${project.version}</Application-Version>
                            <Archiver-Version>Plexus Archiver</Archiver-Version>
                            <Created-By>Apache Maven</Created-By>
                            <Built-By>${user.name}</Built-By>
                            <Build-Jdk>${java.version}</Build-Jdk>
                        </manifestEntries>
                    </archive>
                    <warSourceExcludes>META-INF/*.xml</warSourceExcludes>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                    <warName>inextaweb</warName>
                </configuration>
            </plugin>

            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>exec-maven-plugin</artifactId>
                <version>${exec-maven-plugin.version}</version>
                <executions>
                    <execution>
                        <id>runbatchfile</id>
                        <phase>compile</phase>
                        <goals>
                            <goal>exec</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <executable>browserifyScript.${scriptExtension}</executable>
                </configuration>
            </plugin>

            <plugin>
                <groupId>com.mysema.maven</groupId>
                <artifactId>apt-maven-plugin</artifactId>
                <version>1.1.3</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>process</goal>
                        </goals>
                        <configuration>
                            <outputDirectory>target/generated-sources/java</outputDirectory>
                            <processor>com.querydsl.apt.jpa.JPAAnnotationProcessor</processor>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>

    <!-- =======================================================================
    = PROFILES
    ======================================================================== -->
    <profiles>
        <profile>
            <id>linux-platform</id>
            <!-- to execute shell scripts instead of .bat files -->
            <activation>
                <os>
                    <family>linux</family>
                </os>
            </activation>
            <properties>
                <scriptExtension>sh</scriptExtension>
            </properties>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>exec-maven-plugin</artifactId>
                        <version>${exec-maven-plugin.version}</version>
                        <executions>
                            <execution>
                                <id>exec-yarn-install</id>
                                <configuration>
                                    <executable>yarn</executable>
                                    <arguments>
                                        <argument>--pure-lockfile</argument>
                                        <argument>install</argument>
                                    </arguments>
                                    <skip>${build.nofront}</skip>
                                </configuration>
                                <phase>initialize</phase>
                                <goals>
                                    <goal>exec</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>not</id>
            <!-- NOTests -->
            <properties>
                <skipTests>true</skipTests>
            </properties>
        </profile>

        <profile>
            <id>nexus</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-assembly-plugin</artifactId>
                        <executions>
                            <execution>
                                <phase>package</phase>
                                <goals>
                                    <goal>single</goal>
                                </goals>
                            </execution>
                        </executions>
                        <configuration>
                            <descriptors>
                                <descriptor>assembly.xml</descriptor>
                            </descriptors>
                            <finalName>${assembly.finalName}</finalName>
                            <appendAssemblyId>false</appendAssemblyId>
                            <tarLongFileMode>posix</tarLongFileMode>
                        </configuration>
                    </plugin>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-install-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>default-install</id>
                                <phase>none</phase>
                            </execution>
                        </executions>
                    </plugin>
                    <!-- After creating the assembly, we only keep the .tar.gz, otherwise, the deploy goal will upload both the jar and the assembly -->
                    <!-- Using deploy:deploy-file is not convenient, because we cannot cleanly choose the repository type, ie SNAPSHOT vs STABLE to which we want to upload -->
                    <plugin>
                        <artifactId>maven-clean-plugin</artifactId>
                        <executions>
                            <execution>
                                <!-- we can't override this id -->
                                <id>default-clean</id>
                                <phase>install</phase>
                                <goals>
                                    <goal>clean</goal>
                                </goals>
                                <configuration>
                                    <excludeDefaultDirectories>true</excludeDefaultDirectories>
                                    <filesets>
                                        <fileset>
                                            <directory>${project.build.directory}</directory>
                                            <excludes>
                                                <exclude>${assembly.finalName}.tar.gz</exclude>
                                            </excludes>
                                        </fileset>
                                    </filesets>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
            <distributionManagement>
                <repository>
                    <id>nexus-dgnsi-server</id>
                    <name>Nexus DGNSI</name>
                    <url>${nexus.url}/app-jenkinsdgnsi-stable</url>
                </repository>
                <snapshotRepository>
                    <id>nexus-dgnsi-server</id>
                    <name>Nexus DGNSI</name>
                    <url>${nexus.url}/app-jenkinsdgnsi-snapshots</url>
                    <uniqueVersion>false</uniqueVersion>
                </snapshotRepository>
            </distributionManagement>
        </profile>

        <profile>
            <id>devex.release</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>ch.vd.devex</groupId>
                        <artifactId>devex-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>create</id>
                                <phase>package</phase>
                                <goals>
                                    <goal>create-release</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>devex.in</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>ch.vd.devex</groupId>
                        <artifactId>devex-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>deploy</id>
                                <phase>deploy</phase>
                                <goals>
                                    <goal>deploy</goal>
                                </goals>
                                <configuration>
                                    <environment>IN</environment>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>devex.de</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>ch.vd.devex</groupId>
                        <artifactId>devex-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>deploy</id>
                                <phase>deploy</phase>
                                <goals>
                                    <goal>deploy</goal>
                                </goals>
                                <configuration>
                                    <environment>DE</environment>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>devex.te</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>ch.vd.devex</groupId>
                        <artifactId>devex-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>deploy</id>
                                <phase>deploy</phase>
                                <goals>
                                    <goal>deploy</goal>
                                </goals>
                                <configuration>
                                    <environment>TE</environment>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
</project>
